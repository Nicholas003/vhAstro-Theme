<!DOCTYPE html><html lang=zh-CN><head><meta charset=UTF-8><meta content="ie=edge" http-equiv=X-UA-Compatible><meta content="text/html; charset=UTF-8" http-equiv=Content-Type><meta content="width=device-width,initial-scale=1,user-scalable=no" name=viewport><title>【开源】Cloudflare优选IP➕DnsPod的DDNS自动切换 | 韩小韩博客</title><meta content="Cloudflare, 优选IP, DnsPod, DDNS" name=keywords><meta content=CloudFlare是一个非常优秀的CDN服务，但是CloudFlare也有一个大的毛病——大陆访问速度很慢。国外很多网站都在使用CloudflareCDN，但分配给中国内地访客的IP并不友好（延迟高、丢包多、速度慢）。虽然Cloudflare公开了所有IP段，但想要在这么多IP中找到适合自己的，怕 name=description><meta content="telephone=no, email=no, date=no, address=no" name=format-detection><meta content=【开源】Cloudflare优选IP➕DnsPod的DDNS自动切换 name=title><meta content=https://www.vvhan.com name=site><meta content=.𝙃𝙖𝙣 name=author><meta content="Astro v5.4.2" name=generator><meta content="index, follow, max-image-preview:large" name=robots><meta content=https://i0.wp.com/uxiaohan.github.io/v2/2024/08/1724744026.webp itemprop=image><meta content=.𝙃𝙖𝙣 property=article:author><meta content=article property=og:type><meta content=韩小韩博客 property=og:site_name><meta content=【开源】Cloudflare优选IP➕DnsPod的DDNS自动切换 property=og:title><meta content=CloudFlare是一个非常优秀的CDN服务，但是CloudFlare也有一个大的毛病——大陆访问速度很慢。国外很多网站都在使用CloudflareCDN，但分配给中国内地访客的IP并不友好（延迟高、丢包多、速度慢）。虽然Cloudflare公开了所有IP段，但想要在这么多IP中找到适合自己的，怕 property=og:description><meta content=https://www.vvhan.com/article/cloudflare-ip-dnspod-ddns property=og:url><meta content=https://i0.wp.com/uxiaohan.github.io/v2/2024/08/1724744026.webp property=og:image><meta content=zh_CN property=og:locale><meta content=summary_large_image name=twitter:card><meta content=韩小韩博客 name=twitter:site><meta content=.𝙃𝙖𝙣 name=twitter:creator><meta content=【开源】Cloudflare优选IP➕DnsPod的DDNS自动切换 name=twitter:title><meta content=CloudFlare是一个非常优秀的CDN服务，但是CloudFlare也有一个大的毛病——大陆访问速度很慢。国外很多网站都在使用CloudflareCDN，但分配给中国内地访客的IP并不友好（延迟高、丢包多、速度慢）。虽然Cloudflare公开了所有IP段，但想要在这么多IP中找到适合自己的，怕 name=twitter:description><meta content=https://www.vvhan.com/article/cloudflare-ip-dnspod-ddns name=twitter:url><meta content=https://i0.wp.com/uxiaohan.github.io/v2/2024/08/1724744026.webp name=twitter:image><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.vvhan.com/article/cloudflare-ip-dnspod-ddns"},"headline":"【开源】Cloudflare优选IP➕DnsPod的DDNS自动切换","image":["https://i0.wp.com/uxiaohan.github.io/v2/2024/08/1724744026.webp"],"author":{"@type":"Person","name":".𝙃𝙖𝙣","url":"https://www.vvhan.com"},"publisher":{"@type":"Organization","name":"韩小韩博客","logo":{"@type":"ImageObject","url":"https://www.vvhan.com/assets/images/banner/072c12ec85d2d3b5.webp"}}}</script><link href=/sitemap-index.xml rel=sitemap><link href=https://i0.wp.com rel=dns-prefetch><link href=https://tools-api.vvhan.com rel=dns-prefetch><link href=https://pagead2.googlesyndication.com rel=dns-prefetch><link href=https://lf9-cdn-tos.bytecdntp.com rel=dns-prefetch><link href=https://registry.npmmirror.com rel=dns-prefetch><link href=https://npm.elemecdn.com rel=dns-prefetch><link href=https://i0.wp.com rel=preconnect><link href=https://tools-api.vvhan.com rel=preconnect><link href=https://pagead2.googlesyndication.com rel=preconnect><link href=https://lf9-cdn-tos.bytecdntp.com rel=preconnect><link href=https://registry.npmmirror.com rel=preconnect><link href=https://npm.elemecdn.com rel=preconnect><link href=https://www.vvhan.com/article/cloudflare-ip-dnspod-ddns rel=canonical><link href=/favicon.ico rel=icon type=image/x-icon><script src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-xxxxxx" async crossorigin=anonymous></script><link href=/_astro/Layout.Kcn8suC4.css rel=stylesheet><style>.vh-copyright{position:relative;margin:1.868rem 0;box-sizing:border-box;padding:1rem;width:100%;height:max-content;background-color:#00000008;border-radius:.618rem;overflow:hidden}.vh-copyright a{box-sizing:border-box;padding:1.88px;position:relative;width:max-content;height:max-content;color:#3338;box-shadow:none!important;overflow:hidden}.vh-copyright a:before{position:absolute;right:0;bottom:0;content:"";width:0;height:2px;background-color:#60a5fa;transition:all .3s ease-in-out}.vh-copyright a:hover:before{width:100%;left:0;right:auto}.vh-copyright>p{box-sizing:border-box;padding:.38rem 0!important;width:100%;height:max-content;font-size:.875rem!important}.vh-copyright>p>span{color:#9cc5fb}.vh-copyright>svg{position:absolute;right:3.66rem;top:0;width:auto;height:100%;opacity:.06;transform:scale(1.8);pointer-events:none;z-index:-1}@media screen and (max-width:666px){.vh-copyright>svg{display:none}}</style><link href=/_astro/_page_.L2YuWb9y.css rel=stylesheet><link href=/_astro/index.D7gf6Bhc.css rel=stylesheet><link href=/_astro/_article_.Di18PtnJ.css rel=stylesheet><script src=/_astro/page.BoK7ZbO6.js type=module></script></head><body><nav class=vh-mobilesidebar><section class=main><div class="vh-mobilesidebar-list user-panel"><h3>韩小韩博客</h3></div><div class="vh-link-list vh-mobilesidebar-list"><a href=/links target=_self class=links><object data=/assets/images/svg/Navs/links.svg type=image/svg+xml></object> 朋友 </a><a href=/friends target=_self class=friends><object data=/assets/images/svg/Navs/friends.svg type=image/svg+xml></object> 圈子 </a><a href=/talking target=_self class=talking><object data=/assets/images/svg/Navs/talking.svg type=image/svg+xml></object> 动态 </a><a href=/archives target=_self class=archives><object data=/assets/images/svg/Navs/archives.svg type=image/svg+xml></object> 昔日 </a><a href=/message target=_self class=message><object data=/assets/images/svg/Navs/message.svg type=image/svg+xml></object> 留言 </a><a href=/about target=_self class=about><object data=/assets/images/svg/Navs/about.svg type=image/svg+xml></object> 关于 </a><a href=https://api.vvhan.com/ target=_blank class=https:/api.vvhan.com/ ><object data=/assets/images/svg/Navs/link.svg type=image/svg+xml></object> API</a></div></section></nav><header class=vh-header><section class=main><a href=/ class=index><svg viewBox="0 0 576 512" xmlns=http://www.w3.org/2000/svg><path d="M543.8 287.6c17 0 32-14 32-32.1c1-9-3-17-11-24L309.5 7c-6-5-14-7-21-7s-15 1-22 8L10 231.5c-7 7-10 15-10 24c0 18 14 32.1 32 32.1l32 0 0 160.4c0 35.3 28.7 64 64 64l102.3 0-31.3-52.2c-4.1-6.8-2.6-15.5 3.5-20.5L288 368l-60.2-82.8c-10.9-15 8.2-33.5 22.8-22l117.9 92.6c8 6.3 8.2 18.4 .4 24.9L288 448l38.4 64 122.1 0c35.5 0 64.2-28.8 64-64.3l-.7-160.2 32 0z"></path></svg> Home</a><div class="vh-link-list link-list"><a href=/links target=_self class=links>朋友 <img alt=朋友 decoding=async height=10 loading=lazy src=/assets/images/svg/Navs/links.svg width=10> </a><a href=/friends target=_self class=friends>圈子 <img alt=圈子 decoding=async height=10 loading=lazy src=/assets/images/svg/Navs/friends.svg width=10> </a><a href=/talking target=_self class=talking>动态 <img alt=动态 decoding=async height=10 loading=lazy src=/assets/images/svg/Navs/talking.svg width=10> </a><a href=/archives target=_self class=archives>昔日 <img alt=昔日 decoding=async height=10 loading=lazy src=/assets/images/svg/Navs/archives.svg width=10> </a><a href=/message target=_self class=message>留言 <img alt=留言 decoding=async height=10 loading=lazy src=/assets/images/svg/Navs/message.svg width=10> </a><a href=/about target=_self class=about>关于 <img alt=关于 decoding=async height=10 loading=lazy src=/assets/images/svg/Navs/about.svg width=10> </a><a href=https://api.vvhan.com/ target=_blank class=https:/api.vvhan.com/ >API <img alt=API decoding=async height=10 loading=lazy src=/assets/images/svg/Navs/link.svg width=10></a></div><div class=nav-btn><span class="nav-btn-item search-btn"><svg viewBox="0 0 512 512" xmlns=http://www.w3.org/2000/svg><path d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z"></path></svg> 搜索</span> <span class="nav-btn-item menu-btn"><svg viewBox="0 0 448 512" xmlns=http://www.w3.org/2000/svg><path d="M0 96C0 78.3 14.3 64 32 64l384 0c17.7 0 32 14.3 32 32s-14.3 32-32 32L32 128C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32l384 0c17.7 0 32 14.3 32 32s-14.3 32-32 32L32 288c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32L32 448c-17.7 0-32-14.3-32-32s14.3-32 32-32l384 0c17.7 0 32 14.3 32 32z"></path></svg></span></div><section class=vh-search><main><div class=search-input><svg viewBox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="m19.6 21l-6.3-6.3q-.75.6-1.725.95T9.5 16q-2.725 0-4.612-1.888T3 9.5t1.888-4.612T9.5 3t4.613 1.888T16 9.5q0 1.1-.35 2.075T14.7 13.3l6.3 6.3zM9.5 14q1.875 0 3.188-1.312T14 9.5t-1.312-3.187T9.5 5T6.313 6.313T5 9.5t1.313 3.188T9.5 14" fill=#B4B4B4></path></svg> <input placeholder=搜索文章 type=text></div><section class=vh-search-list><em></em></section></main></section></section></header><main class=vh-main><section class=vh-container><article class="vh-animation vh-animation-init vh-article-main"><header><h1>【开源】Cloudflare优选IP➕DnsPod的DDNS自动切换</h1><div class=article-meta><span class=article-meta-item><svg viewBox="0 0 448 512" xmlns=http://www.w3.org/2000/svg><path d="M152 24c0-13.3-10.7-24-24-24s-24 10.7-24 24l0 40L64 64C28.7 64 0 92.7 0 128l0 16 0 48L0 448c0 35.3 28.7 64 64 64l320 0c35.3 0 64-28.7 64-64l0-256 0-48 0-16c0-35.3-28.7-64-64-64l-40 0 0-40c0-13.3-10.7-24-24-24s-24 10.7-24 24l0 40L152 64l0-40zM48 192l80 0 0 56-80 0 0-56zm0 104l80 0 0 64-80 0 0-64zm128 0l96 0 0 64-96 0 0-64zm144 0l80 0 0 64-80 0 0-64zm80-48l-80 0 0-56 80 0 0 56zm0 160l0 40c0 8.8-7.2 16-16 16l-64 0 0-56 80 0zm-128 0l0 56-96 0 0-56 96 0zm-144 0l0 56-64 0c-8.8 0-16-7.2-16-16l0-40 80 0zM272 248l-96 0 0-56 96 0 0 56z"></path></svg> <time>2024-08-27 下午</time> <span class=count><strong>408</strong>字</span> <span class=time><strong>2</strong>分钟</span> </span><a href=/categories/Code class=article-meta-item><svg viewBox="0 0 512 512" xmlns=http://www.w3.org/2000/svg><path d="M40 48C26.7 48 16 58.7 16 72l0 48c0 13.3 10.7 24 24 24l48 0c13.3 0 24-10.7 24-24l0-48c0-13.3-10.7-24-24-24L40 48zM192 64c-17.7 0-32 14.3-32 32s14.3 32 32 32l288 0c17.7 0 32-14.3 32-32s-14.3-32-32-32L192 64zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32l288 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-288 0zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32l288 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-288 0zM16 232l0 48c0 13.3 10.7 24 24 24l48 0c13.3 0 24-10.7 24-24l0-48c0-13.3-10.7-24-24-24l-48 0c-13.3 0-24 10.7-24 24zM40 368c-13.3 0-24 10.7-24 24l0 48c0 13.3 10.7 24 24 24l48 0c13.3 0 24-10.7 24-24l0-48c0-13.3-10.7-24-24-24l-48 0z"></path></svg> <span>Code</span></a></div></header><main><section class="vh-node vh-note"><p>CloudFlare是一个非常优秀的CDN服务，但是CloudFlare也有一个大的毛病——大陆访问速度很慢。国外很多网站都在使用 Cloudflare CDN，但分配给中国内地访客的IP并不友好（延迟高、丢包多、速度慢）。 虽然Cloudflare公开了所有IP段，但想要在这么多IP中找到适合自己的，怕是要累死，于是就有了这个脚本。</p></section><h2 id=cloudflare优选ip-每隔15分钟更新ipv6ipv4>Cloudflare优选IP 每隔15分钟更新(IPv6+IPv4)</h2><h3 id=项目地址>项目地址</h3><a href=https://github.com/uxiaohan/CloudflareIP-dnspod-ddns target=_blank class="vh-node vh-btn" rel="noopener nofollow"><span>CloudflareIP-dnspod-ddns</span></a><h3 id=优化后示例站点>优化后示例站点</h3><a href=https://cf.vvhan.com/ target=_blank class="vh-node vh-btn" rel="noopener nofollow"><span>点击体验</span></a><h2 id=实现逻辑及局部代码>实现逻辑及局部代码</h2><h3 id=获取优选ip>获取优选IP</h3><section class=vh-code-box><span class=vh-code-copy></span><pre class="astro-code github-light" data-language=js style=background-color:#fff;color:#24292e;overflow-x:auto tabindex=0><code><span class=line><span style=color:#d73a49>const</span><span style=color:#005cc5> res</span><span style=color:#d73a49> =</span><span style=color:#d73a49> await</span><span style=color:#6f42c1> fetch</span><span style=color:#24292e>(</span><span style=color:#032f62>"https://api.vvhan.com/tool/cf_ip"</span><span style=color:#24292e>);</span></span>
<span class=line><span style=color:#d73a49>const</span><span style=color:#005cc5> data</span><span style=color:#d73a49> =</span><span style=color:#d73a49> await</span><span style=color:#24292e> res.</span><span style=color:#6f42c1>json</span><span style=color:#24292e>();</span></span>
<span class=line><span style=color:#6a737d>// 数据格式</span></span>
<span class=line><span style=color:#6a737d>// {</span></span>
<span class=line><span style=color:#6a737d>//     "success": true,</span></span>
<span class=line><span style=color:#6a737d>//     "data": {</span></span>
<span class=line><span style=color:#6a737d>//         "v4": {</span></span>
<span class=line><span style=color:#6a737d>//             "CM": [],</span></span>
<span class=line><span style=color:#6a737d>//             "CU": [],</span></span>
<span class=line><span style=color:#6a737d>//             "CT": []</span></span>
<span class=line><span style=color:#6a737d>//         },</span></span>
<span class=line><span style=color:#6a737d>//         "v6": {</span></span>
<span class=line><span style=color:#6a737d>//             "CM": [],</span></span>
<span class=line><span style=color:#6a737d>//             "CU": [],</span></span>
<span class=line><span style=color:#6a737d>//             "CT": []</span></span>
<span class=line><span style=color:#6a737d>//         }</span></span>
<span class=line><span style=color:#6a737d>//     }</span></span>
<span class=line><span style=color:#6a737d>// }</span></span></code></pre></section><h3 id=取优选ip中的最优选-延迟比较>取优选IP中的最优选 (延迟比较)</h3><section class=vh-code-box><span class=vh-code-copy></span><pre class="astro-code github-light" data-language=js style=background-color:#fff;color:#24292e;overflow-x:auto tabindex=0><code><span class=line><span style=color:#6a737d>// 取最优选IP IPv4</span></span>
<span class=line><span style=color:#d73a49>const</span><span style=color:#005cc5> CM_IP_V4</span><span style=color:#d73a49> =</span><span style=color:#24292e> data.v4.</span><span style=color:#005cc5>CM</span><span style=color:#24292e>.</span><span style=color:#6f42c1>reduce</span><span style=color:#24292e>((</span><span style=color:#e36209>minItem</span><span style=color:#24292e>, </span><span style=color:#e36209>currentItem</span><span style=color:#24292e>) </span><span style=color:#d73a49>=></span><span style=color:#24292e> {</span></span>
<span class=line><span style=color:#d73a49>  return</span><span style=color:#24292e> currentItem.latency </span><span style=color:#d73a49>&#x3C;</span><span style=color:#24292e> minItem.latency </span><span style=color:#d73a49>?</span><span style=color:#24292e> currentItem </span><span style=color:#d73a49>:</span><span style=color:#24292e> minItem;</span></span>
<span class=line><span style=color:#24292e>}, data.v4.</span><span style=color:#005cc5>CM</span><span style=color:#24292e>[</span><span style=color:#005cc5>0</span><span style=color:#24292e>]);</span></span>
<span class=line><span style=color:#d73a49>const</span><span style=color:#005cc5> CU_IP_V4</span><span style=color:#d73a49> =</span><span style=color:#24292e> data.v4.</span><span style=color:#005cc5>CU</span><span style=color:#24292e>.</span><span style=color:#6f42c1>reduce</span><span style=color:#24292e>((</span><span style=color:#e36209>minItem</span><span style=color:#24292e>, </span><span style=color:#e36209>currentItem</span><span style=color:#24292e>) </span><span style=color:#d73a49>=></span><span style=color:#24292e> {</span></span>
<span class=line><span style=color:#d73a49>  return</span><span style=color:#24292e> currentItem.latency </span><span style=color:#d73a49>&#x3C;</span><span style=color:#24292e> minItem.latency </span><span style=color:#d73a49>?</span><span style=color:#24292e> currentItem </span><span style=color:#d73a49>:</span><span style=color:#24292e> minItem;</span></span>
<span class=line><span style=color:#24292e>}, data.v4.</span><span style=color:#005cc5>CU</span><span style=color:#24292e>[</span><span style=color:#005cc5>0</span><span style=color:#24292e>]);</span></span>
<span class=line><span style=color:#d73a49>const</span><span style=color:#005cc5> CT_IP_V4</span><span style=color:#d73a49> =</span><span style=color:#24292e> data.v4.</span><span style=color:#005cc5>CT</span><span style=color:#24292e>.</span><span style=color:#6f42c1>reduce</span><span style=color:#24292e>((</span><span style=color:#e36209>minItem</span><span style=color:#24292e>, </span><span style=color:#e36209>currentItem</span><span style=color:#24292e>) </span><span style=color:#d73a49>=></span><span style=color:#24292e> {</span></span>
<span class=line><span style=color:#d73a49>  return</span><span style=color:#24292e> currentItem.latency </span><span style=color:#d73a49>&#x3C;</span><span style=color:#24292e> minItem.latency </span><span style=color:#d73a49>?</span><span style=color:#24292e> currentItem </span><span style=color:#d73a49>:</span><span style=color:#24292e> minItem;</span></span>
<span class=line><span style=color:#24292e>}, data.v4.</span><span style=color:#005cc5>CT</span><span style=color:#24292e>[</span><span style=color:#005cc5>0</span><span style=color:#24292e>]);</span></span>
<span class=line><span style=color:#d73a49>const</span><span style=color:#005cc5> DNS_DATA_V4</span><span style=color:#d73a49> =</span><span style=color:#24292e> { 移动: </span><span style=color:#005cc5>CM_IP_V4</span><span style=color:#24292e>.ip, 联通: </span><span style=color:#005cc5>CM_IP_V4</span><span style=color:#24292e>.ip, 电信: </span><span style=color:#005cc5>CU_IP_V4</span><span style=color:#24292e>.ip, 默认: </span><span style=color:#005cc5>CT_IP_V4</span><span style=color:#24292e>.ip };</span></span>
<span class=line></span>
<span class=line><span style=color:#6a737d>// 取最优选IP IPv6</span></span>
<span class=line><span style=color:#d73a49>const</span><span style=color:#005cc5> CM_IP_V6</span><span style=color:#d73a49> =</span><span style=color:#24292e> data.v6.</span><span style=color:#005cc5>CM</span><span style=color:#24292e>.</span><span style=color:#6f42c1>reduce</span><span style=color:#24292e>((</span><span style=color:#e36209>minItem</span><span style=color:#24292e>, </span><span style=color:#e36209>currentItem</span><span style=color:#24292e>) </span><span style=color:#d73a49>=></span><span style=color:#24292e> {</span></span>
<span class=line><span style=color:#d73a49>  return</span><span style=color:#24292e> currentItem.latency </span><span style=color:#d73a49>&#x3C;</span><span style=color:#24292e> minItem.latency </span><span style=color:#d73a49>?</span><span style=color:#24292e> currentItem </span><span style=color:#d73a49>:</span><span style=color:#24292e> minItem;</span></span>
<span class=line><span style=color:#24292e>}, data.v6.</span><span style=color:#005cc5>CM</span><span style=color:#24292e>[</span><span style=color:#005cc5>0</span><span style=color:#24292e>]);</span></span>
<span class=line><span style=color:#d73a49>const</span><span style=color:#005cc5> CU_IP_V6</span><span style=color:#d73a49> =</span><span style=color:#24292e> data.v6.</span><span style=color:#005cc5>CU</span><span style=color:#24292e>.</span><span style=color:#6f42c1>reduce</span><span style=color:#24292e>((</span><span style=color:#e36209>minItem</span><span style=color:#24292e>, </span><span style=color:#e36209>currentItem</span><span style=color:#24292e>) </span><span style=color:#d73a49>=></span><span style=color:#24292e> {</span></span>
<span class=line><span style=color:#d73a49>  return</span><span style=color:#24292e> currentItem.latency </span><span style=color:#d73a49>&#x3C;</span><span style=color:#24292e> minItem.latency </span><span style=color:#d73a49>?</span><span style=color:#24292e> currentItem </span><span style=color:#d73a49>:</span><span style=color:#24292e> minItem;</span></span>
<span class=line><span style=color:#24292e>}, data.v6.</span><span style=color:#005cc5>CU</span><span style=color:#24292e>[</span><span style=color:#005cc5>0</span><span style=color:#24292e>]);</span></span>
<span class=line><span style=color:#d73a49>const</span><span style=color:#005cc5> CT_IP_V6</span><span style=color:#d73a49> =</span><span style=color:#24292e> data.v6.</span><span style=color:#005cc5>CT</span><span style=color:#24292e>.</span><span style=color:#6f42c1>reduce</span><span style=color:#24292e>((</span><span style=color:#e36209>minItem</span><span style=color:#24292e>, </span><span style=color:#e36209>currentItem</span><span style=color:#24292e>) </span><span style=color:#d73a49>=></span><span style=color:#24292e> {</span></span>
<span class=line><span style=color:#d73a49>  return</span><span style=color:#24292e> currentItem.latency </span><span style=color:#d73a49>&#x3C;</span><span style=color:#24292e> minItem.latency </span><span style=color:#d73a49>?</span><span style=color:#24292e> currentItem </span><span style=color:#d73a49>:</span><span style=color:#24292e> minItem;</span></span>
<span class=line><span style=color:#24292e>}, data.v6.</span><span style=color:#005cc5>CT</span><span style=color:#24292e>[</span><span style=color:#005cc5>0</span><span style=color:#24292e>]);</span></span>
<span class=line><span style=color:#d73a49>const</span><span style=color:#005cc5> DNS_DATA_V6</span><span style=color:#d73a49> =</span><span style=color:#24292e> { 移动: </span><span style=color:#005cc5>CM_IP_V6</span><span style=color:#24292e>.ip, 联通: </span><span style=color:#005cc5>CM_IP_V6</span><span style=color:#24292e>.ip, 电信: </span><span style=color:#005cc5>CU_IP_V6</span><span style=color:#24292e>.ip, 默认: </span><span style=color:#005cc5>CT_IP_V6</span><span style=color:#24292e>.ip };</span></span></code></pre></section><h3 id=循环替换优选ip>循环替换优选IP</h3><section class=vh-code-box><span class=vh-code-copy></span><pre class="astro-code github-light" data-language=js style=background-color:#fff;color:#24292e;overflow-x:auto tabindex=0><code><span class=line><span style=color:#24292e>DnsPodDomainList.</span><span style=color:#6f42c1>forEach</span><span style=color:#24292e>(</span><span style=color:#d73a49>async</span><span style=color:#e36209> i</span><span style=color:#d73a49> =></span><span style=color:#24292e> {</span></span>
<span class=line><span style=color:#d73a49>  try</span><span style=color:#24292e> {</span></span>
<span class=line><span style=color:#d73a49>    const</span><span style=color:#005cc5> res</span><span style=color:#d73a49> =</span><span style=color:#d73a49> await</span><span style=color:#24292e> client.</span><span style=color:#6f42c1>ModifyRecord</span><span style=color:#24292e>({ Domain, RecordType: i.Type, RecordLine: </span><span style=color:#032f62>""</span><span style=color:#24292e>, RecordLineId: i.LineId, Value: i.Type </span><span style=color:#d73a49>==</span><span style=color:#032f62> "A"</span><span style=color:#d73a49> ?</span><span style=color:#005cc5> DNS_DATA_V4</span><span style=color:#24292e>[i.Line] </span><span style=color:#d73a49>:</span><span style=color:#005cc5> DNS_DATA_V6</span><span style=color:#24292e>[i.Line], RecordId: i.RecordId, SubDomain });</span></span>
<span class=line><span style=color:#24292e>    console.</span><span style=color:#6f42c1>log</span><span style=color:#24292e>(res);</span></span>
<span class=line><span style=color:#24292e>  } </span><span style=color:#d73a49>catch</span><span style=color:#24292e> (error) {</span></span>
<span class=line><span style=color:#24292e>    console.</span><span style=color:#6f42c1>log</span><span style=color:#24292e>(error);</span></span>
<span class=line><span style=color:#24292e>  }</span></span>
<span class=line><span style=color:#24292e>});</span></span></code></pre></section><nav class=tag-list><a href=/tag/Cloudflare>Cloudflare</a><a href=/tag/优选IP>优选IP</a><a href=/tag/DnsPod>DnsPod</a><a href=/tag/DDNS>DDNS</a></nav></main><footer><div class="vh-ad vh-article-ad"><ins class=adsbygoogle data-ad-client=ca-pub-xxxxxx data-ad-format=auto data-ad-slot=xxxxxx data-full-width-responsive=true style=display:block></ins></div><section class=vh-copyright><p>本文由 <span>.𝙃𝙖𝙣</span> 于 2024-08-27 下午 发布</p><p>文章地址：<a href=https://www.vvhan.com/article/cloudflare-ip-dnspod-ddns>【开源】Cloudflare优选IP➕DnsPod的DDNS自动切换</a></p><p>本博客所有文章除特别声明外，均采用 <a href=https://creativecommons.org/licenses/by-nc-sa/4.0 target=_blank rel="noopener nofollow">CC BY-NC-SA 4.0</a> 许可协议。完整转载请注明来自 <a href=https://www.vvhan.com>韩小韩博客</a>！</p><svg viewBox="0 0 496 512" xmlns=http://www.w3.org/2000/svg><path d="M245.8 214.9l-33.2 17.3c-9.4-19.6-25.2-19.9-27.5-19.9-22.1 0-33.2 14.6-33.2 43.8 0 23.6 9.2 43.8 33.2 43.8 14.5 0 24.7-7.1 30.6-21.3l30.6 15.5c-6.2 11.5-25.7 39-65.1 39-22.6 0-74-10.3-74-77.1 0-58.7 43-77.1 72.6-77.1 30.7 0 52.7 12 66 35.9zm143.1 0l-32.8 17.3c-9.5-19.8-25.7-19.9-27.9-19.9-22.1 0-33.2 14.6-33.2 43.8 0 23.6 9.2 43.8 33.2 43.8 14.5 0 24.7-7.1 30.5-21.3l31 15.5c-2.1 3.8-21.4 39-65.1 39-22.7 0-74-9.9-74-77.1 0-58.7 43-77.1 72.6-77.1 30.7 0 52.6 12 65.6 35.9zM247.6 8.1C104.7 8.1 0 123.1 0 256.1c0 138.5 113.6 248 247.6 248 129.9 0 248.4-100.9 248.4-248 0-137.9-106.6-248-248.4-248zm.9 450.8c-112.5 0-203.7-93-203.7-202.8 0-105.4 85.4-203.3 203.7-203.3 112.5 0 202.8 89.5 202.8 203.3 0 121.7-99.7 202.8-202.8 202.8z"></path></svg></section></footer><section class=vh-comment><section></section></section></article><aside class=vh-aside><section class="vh-aside-item user"><img alt=.𝙃𝙖𝙣 decoding=async height=1 loading=lazy src=/assets/images/lazy-loading.webp width=1 data-vh-lz-src="https://q1.qlogo.cn/g?b=qq&nk=1655466387&s=640" class=vh-aside-avatar> <span class=vh-aside-auther>.𝙃𝙖𝙣</span><p class=vh-aside-motto>运气是计划之外的东西.</p><section class=vh-aside-links><a href=https://github.com/uxiaohan target=_blank class=vh-aside-links-item rel="noopener nofollow" title=Github><img alt=Github decoding=async height=1 loading=lazy src=/assets/images/svg/WebSites/github.svg width=1> </a><a href=https://api.vvhan.com target=_blank class=vh-aside-links-item rel="noopener nofollow" title=韩小韩API><img alt=韩小韩API decoding=async height=1 loading=lazy src=/assets/images/svg/WebSites/api.svg width=1> </a><a href=https://hot.vvhan.com target=_blank class=vh-aside-links-item rel="noopener nofollow" title=每日热榜><img alt=每日热榜 decoding=async height=1 loading=lazy src=/assets/images/svg/WebSites/hot.svg width=1> </a><a href=https://wp-cdn.4ce.cn target=_blank class=vh-aside-links-item rel="noopener nofollow" title=骤雨重山图床><img alt=骤雨重山图床 decoding=async height=1 loading=lazy src=/assets/images/svg/WebSites/img.svg width=1> </a><a href=https://analytics.vvhan.com target=_blank class=vh-aside-links-item rel="noopener nofollow" title=HanAnalytics><img alt=HanAnalytics decoding=async height=1 loading=lazy src=/assets/images/svg/WebSites/analytics.svg width=1></a></section></section><section class="vh-aside-item categories"><h3>分类</h3><div class=vh-aside-categories><a href=/categories/Code><span>Code</span> <i>5</i> </a><a href=/categories/Daily><span>Daily</span> <i>2</i></a></div></section><section class="vh-aside-item tags"><h3>热门标签</h3><div class=vh-aside-tags><a href=/tag/开源><span>开源</span> </a><a href="/tag/Cloudflare Pages"><span>Cloudflare Pages</span> </a><a href=/tag/Astro><span>Astro</span> </a><a href=/tag/主题><span>主题</span> </a><a href=/tag/博客><span>博客</span> </a><a href=/tag/vhAstro><span>vhAstro</span> </a><a href=/tag/vhAstro-Theme><span>vhAstro-Theme</span> </a><a href=/tag/Tarot><span>Tarot</span> </a><a href=/tag/塔罗牌占卜><span>塔罗牌占卜</span> </a><a href=/tag/Tarot-Web><span>Tarot-Web</span> </a><a href=/tag/水印><span>水印</span> </a><a href=/tag/WebWatermark><span>WebWatermark</span> </a><a href=/tag/HanAnalytics><span>HanAnalytics</span> </a><a href=/tag/umami><span>umami</span> </a><a href="/tag/Analytics Engine"><span>Analytics Engine</span> </a><a href=/tag/网站分析><span>网站分析</span></a></div></section><section class=sticky-aside><section class="vh-aside-item articles"><h3>推荐文章</h3><div class=vh-aside-articles><a href=/article/astro-theme-vhastro-theme><p class=cover><img alt=Astro主题-优雅的vhAstro-Theme【使用文档】 decoding=async height=1 loading=lazy src=/assets/images/lazy-loading.webp width=1 data-vh-lz-src=https://i0.wp.com/uxiaohan.github.io/v2/2025/03/1740977096666.webp></p><p class=info><span>Astro主题-优雅的vhAstro-Theme【使用文档】</span> <time>2025-03-02 晚上</time></p></a><a href=/article/Web-Watermark><p class=cover><img alt="【开源】Web Watermark 图片添加水印在线小助手" decoding=async height=1 loading=lazy src=/assets/images/lazy-loading.webp width=1 data-vh-lz-src=https://i0.wp.com/uxiaohan.github.io/v2/2025/02/1739241633608.webp></p><p class=info><span>【开源】Web Watermark 图片添加水印在线小助手</span> <time>2024-11-21 下午</time></p></a><a href=/article/han-analytics><p class=cover><img alt="【开源】HanAnalytics访问分析Web统计托管于（Cloudflare Pages）" decoding=async height=1 loading=lazy src=/assets/images/lazy-loading.webp width=1 data-vh-lz-src=https://i0.wp.com/uxiaohan.github.io/v2/2024/09/1727007937.webp></p><p class=info><span>【开源】HanAnalytics访问分析Web统计托管于（Cloudflare Pages）</span> <time>2024-09-22 晚上</time></p></a><a href=/article/weibo-dynamic-emotion-analysis-open-source><p class=cover><img alt=基于AI的微博动态心情分析【开源】 decoding=async height=1 loading=lazy src=/assets/images/lazy-loading.webp width=1 data-vh-lz-src=https://i0.wp.com/uxiaohan.github.io/v2/2024/09/1725437035.webp></p><p class=info><span>基于AI的微博动态心情分析【开源】</span> <time>2024-09-04 下午</time></p></a><a href=/article/cloudflare-ip-dnspod-ddns><p class=cover><img alt=【开源】Cloudflare优选IP➕DnsPod的DDNS自动切换 decoding=async height=1 loading=lazy src=/assets/images/lazy-loading.webp width=1 data-vh-lz-src=https://i0.wp.com/uxiaohan.github.io/v2/2024/08/1724744026.webp></p><p class=info><span>【开源】Cloudflare优选IP➕DnsPod的DDNS自动切换</span> <time>2024-08-27 下午</time></p></a><a href=/article/zycs-img-cloud-from-cloudflare-pages><p class=cover><img alt="【开源】骤雨重山无限存储图床托管于（Cloudflare Pages）" decoding=async height=1 loading=lazy src=/assets/images/lazy-loading.webp width=1 data-vh-lz-src=https://i0.wp.com/uxiaohan.github.io/v2/2024/07/1721643791.png></p><p class=info><span>【开源】骤雨重山无限存储图床托管于（Cloudflare Pages）</span> <time>2024-07-22 晚上</time></p></a></div></section><section class="vh-aside-item ad"><h3>广而告之</h3><div class="vh-ad vh-aside-ad"><ins class=adsbygoogle data-ad-client=ca-pub-xxxxxx data-ad-format=auto data-ad-slot=xxxxxx data-full-width-responsive=true style=display:block></ins></div></section></section></aside></section></main><footer class=vh-footer><main><p><img alt=韩小韩 decoding=async height=1 loading=lazy src=/assets/images/footer/ing.svg width=1><span><svg viewBox="0 0 512 512" xmlns=http://www.w3.org/2000/svg><path d="M269.4 2.9C265.2 1 260.7 0 256 0s-9.2 1-13.4 2.9L54.3 82.8c-22 9.3-38.4 31-38.3 57.2c.5 99.2 41.3 280.7 213.6 363.2c16.7 8 36.1 8 52.8 0C454.7 420.7 495.5 239.2 496 140c.1-26.2-16.3-47.9-38.3-57.2L269.4 2.9zM144 221.3c0-33.8 27.4-61.3 61.3-61.3c16.2 0 31.8 6.5 43.3 17.9l7.4 7.4 7.4-7.4c11.5-11.5 27.1-17.9 43.3-17.9c33.8 0 61.3 27.4 61.3 61.3c0 16.2-6.5 31.8-17.9 43.3l-82.7 82.7c-6.2 6.2-16.4 6.2-22.6 0l-82.7-82.7c-11.5-11.5-17.9-27.1-17.9-43.3z" fill=#fff></path></svg><cite>稳定运行</cite><em class=web_time></em></span><a href=https://analytics.vvhan.com target=_blank rel="noopener noreferrer"><img alt=HanAnalytics decoding=async height=1 loading=lazy src=/assets/images/footer/hananalytics.svg width=1></a></p><p><a href=https://astro.build/ target=_blank rel="noopener noreferrer"><img alt=Astro decoding=async height=1 loading=lazy src=/assets/images/footer/astro.svg width=1></a><a href=https://github.com/uxiaohan/vhAstro-Theme target=_blank rel="noopener noreferrer"><img alt=vhAstro-Theme decoding=async height=1 loading=lazy src=/assets/images/footer/theme.svg width=1></a><a href=/sitemap-index.xml target=_blank><img alt=sitemap decoding=async height=1 loading=lazy src=/assets/images/footer/sitemap.svg width=1></a><a href=/rss.xml target=_blank><img alt=rss decoding=async height=1 loading=lazy src=/assets/images/footer/rss.svg width=1></a><a href=https://beian.miit.gov.cn/ target=_blank rel="noopener noreferrer"><img alt=icp decoding=async height=1 loading=lazy src=/assets/images/footer/icp.svg width=1></a></p></main></footer><section class=vh-back-top><svg viewBox="0 0 24 24"><defs><linearGradient id=Gradient x1=0% x2=100% y1=0% y2=0%><stop offset=0% style=stop-color:blue;stop-opacity:1></stop><stop offset=50% style=stop-color:violet;stop-opacity:1></stop><stop offset=100% style=stop-color:indigo;stop-opacity:1></stop></linearGradient></defs><circle cx=12 cy=12 fill=none r=10 stroke=url(#Gradient) stroke-linecap=round stroke-width=2 transform="rotate(-90, 12, 12)"></circle></svg> <svg viewBox="0 0 24 24" class=icon><path d="m6 15l6-6l6 6" fill=none stroke=#000 stroke-linecap=round stroke-linejoin=round stroke-width=2></path></svg></section><script src=/_astro/Layout.astro_astro_type_script_index_0_lang._ZBus-Nv.js type=module></script></body></html>